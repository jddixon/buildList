#!/bin/bash
#
# For all currently valid combinations, verify that the BuildList,
# data directories (dataDir), and content-keyed directories (uDir) 
# generated by bl_createtestdata1 are mutually consistent.
#
# This test is made on data written to tmp/testData.  For production
# use bl_createtestdata1 writes to the local repository mirrored by
# https://github.com/jddixon/xl_testData.

# Wipe and rewrite tmp/testData.
src/bl_createtestdata1 -Tf

# Test the 9 combinations (3 SHA hash types, 3 ways of structuring directories.

src/bl_check -1 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha1/example.bld \
    -u tmp/testData/derived/sha1/DIR_FLAT/uDir

src/bl_check -1 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha1/example.bld \
    -u tmp/testData/derived/sha1/DIR16x16/uDir

src/bl_check -1 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha1/example.bld \
    -u tmp/testData/derived/sha1/DIR256x256/uDir


src/bl_check -2 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha2/example.bld \
    -u tmp/testData/derived/sha2/DIR_FLAT/uDir

src/bl_check -2 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha2/example.bld \
    -u tmp/testData/derived/sha2/DIR16x16/uDir

src/bl_check -2 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha2/example.bld \
    -u tmp/testData/derived/sha2/DIR256x256/uDir


src/bl_check -3 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha3/example.bld \
    -u tmp/testData/derived/sha3/DIR_FLAT/uDir

src/bl_check -3 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha3/example.bld \
    -u tmp/testData/derived/sha3/DIR16x16/uDir

src/bl_check -3 \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/sha3/example.bld \
    -u tmp/testData/derived/sha3/DIR256x256/uDir


src/bl_check -B \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/blake2b/example.bld \
    -u tmp/testData/derived/blake2b/DIR_FLAT/uDir

src/bl_check -B \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/blake2b/example.bld \
    -u tmp/testData/derived/blake2b/DIR16x16/uDir

src/bl_check -B \
    -d tmp/testData/dataDir \
    -b tmp/testData/derived/blake2b/example.bld \
    -u tmp/testData/derived/blake2b/DIR256x256/uDir


